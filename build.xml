<?xml version="1.0" encoding="UTF-8"?>
<!-- 新建一个项目 -->
<project name="AntJunit" default="compiletest" basedir=".">

    <!-- 包含源代码的文件夹 -->
    <property name="src.dir" value="src" />

    <!-- 单元测试源代码的文件夹 -->
    <property name="test.dir" value="test" />


    <!-- 单元测试引入 Junit 的 jar 文件夹 -->
    <property name="junit.dir" value="/Applications/IntelliJ IDEA 15.app/Contents/lib" />
    <path id="junit.path">
        <fileset dir="${junit.dir}">
            <include name="*.jar"/>
        </fileset>
    </path>

    <!-- 引入 Json 的 jar 的文件夹 -->
    <property name="lib.dir" value="lib" />
    <path id="jar.path">
        <fileset dir="${lib.dir}">
            <include name="*.jar"/>
        </fileset>
    </path>

    <!-- 暂时存储结果的文件夹 -->
    <property name="build.dir" value="build" />
    <property name="build.classes" value="${build.dir}/classes" />
    <property name="build.lib" value="${build.dir}/lib" />

    <!-- 编译前新建文件夹 -->
    <target name="prepare" description="Create directories for compiling.">
        <mkdir dir="${build.dir}" />
        <mkdir dir="${build.classes}" />
        <mkdir dir="${build.lib}" />
    </target>

    <!-- 编译后删除文件 -->
    <target name="clean" description="Removes all generated files." >
        <delete dir="${build.dir}" />
    </target>

    <!-- 编译工程文件代码 -->
    <target name="compile" depends="prepare" description="Compiles all source code.">
        <javac srcdir="${src.dir}" destdir="${build.classes}" includeantruntime="false" >
            <classpath refid="jar.path" />
        </javac>
    </target>

    <!-- 编译单元测试文件代码 -->
    <target name="compiletest" depends="prepare, compile" description="Compiles all junit code.">
        <javac srcdir="${test.dir}" destdir="${build.classes}" includeantruntime="false" >
            <classpath refid="junit.path" />
        </javac>
    </target>

    <!-- 打包成 jar 文件 -->
    <target name="jar" depends="compiletest" description="Generate test.jar in build/lib">
        <jar jarfile="${build.lib}/MainClass.jar" basedir="${build.classes}" excludes="**/*Test.class" />
    </target>

    <!-- 运行 jar 文件 -->
    <target name="run" depends="jar" description="Run the main.jar">
        <java classname="" classpath="MainClass.jar" />
    </target>

    <!-- 全部执行 -->
    <target name="all" depends="clean, run" description="Cleans, compiles and build the test.jar" />

</project>